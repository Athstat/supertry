# Edit Team Flow Test
# Tests the team editing functionality
# Prerequisites: User must be logged in and have at least one team
# Flow: Navigate to team → Edit team → Make changes → Save

url: ${BASE_URL}
tags:
  - teams
  - edit-team
---
# Use helper flow to login first
- runFlow: ../helpers/login-helper.yaml

# ============================================
# Navigate to My Teams
# ============================================
# Look for My Teams link
- assertVisible:
    text: ".*([Mm]y [Tt]eams).*"

# Tap on My Teams
- tapOn:
    text: ".*([Mm]y [Tt]eams).*"

# Wait for navigation
- waitForAnimationToEnd

# ============================================
# Verify Teams List
# ============================================
- assertVisible:
    text: ".*([Yy]our [Tt]eams|[Mm]y [Tt]eams).*"

# Take screenshot of teams list
- takeScreenshot: my-teams-list

# ============================================
# Select First Team
# ============================================
# Tap on first team card
- tapOn:
    text: ".*[Tt]eam.*"
    index: 0

# Wait for team details to load
- waitForAnimationToEnd

# ============================================
# Verify Team Details Screen
# ============================================
- assertVisible:
    text: ".*([Tt]eam [Dd]etails|[Pp]layers).*"

# Take screenshot of team details
- takeScreenshot: team-details

# ============================================
# Navigate to Edit Mode
# ============================================
# Look for Edit Team button
- assertVisible:
    text: ".*([Ee]dit [Tt]eam|[Ee]dit).*"

# Tap on Edit Team
- tapOn:
    text: ".*([Ee]dit [Tt]eam|[Ee]dit).*"

# Wait for edit mode to load
- waitForAnimationToEnd

# ============================================
# Make a Transfer (Remove and Add Player)
# ============================================
# Verify budget is displayed
- assertVisible:
    text: ".*([Bb]udget|[Rr]emaining).*"

# Look for remove/transfer button on a player
- assertVisible:
    text: ".*([Rr]emove|[Tt]ransfer).*"
    optional: true

# Take screenshot of edit mode
- takeScreenshot: team-edit-mode

# Tap on remove button for a player
- tapOn:
    text: ".*([Rr]emove|X).*"
    optional: true
    index: 0

# Wait for removal
- waitForAnimationToEnd

# ============================================
# Add New Player
# ============================================
# Tap on empty position or Add Player button
- tapOn:
    text: ".*([Aa]dd [Pp]layer|[Ss]elect).*"
    optional: true
    index: 0

# Wait for player selection modal
- waitForAnimationToEnd

# Select a player
- tapOn:
    text: ".*([Pp]layer).*"
    optional: true
    index: 0

# Confirm selection
- tapOn:
    text: ".*([Cc]onfirm|[Aa]dd).*"
    optional: true

# Wait for modal to close
- waitForAnimationToEnd

# Take screenshot after changes
- takeScreenshot: team-modified

# ============================================
# Save Changes
# ============================================
# Scroll to find Save button
- scroll:
    direction: down

# Look for Save button
- assertVisible:
    text: ".*([Ss]ave|[Ss]ave [Cc]hanges).*"

# Tap Save button
- tapOn:
    text: ".*([Ss]ave|[Ss]ave [Cc]hanges).*"

# Wait for save to complete
- waitForAnimationToEnd

# ============================================
# Verify Success
# ============================================
# Check for success message or confirmation
- assertVisible:
    text: ".*([Ss]aved|[Ss]uccess|[Uu]pdated).*"
    optional: true

# Take screenshot of updated team
- takeScreenshot: team-updated

# Output test results
- evalScript: |
    console.log('✅ Edit Team Flow Test Passed');
    console.log('Team editing interface accessible');
    console.log('Changes saved successfully');
